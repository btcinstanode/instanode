#!/bin/bash

# Eyecandy #############################################

# Colors
NC="\e[39m"
RED="\e[31m"
GREEN="\e[32m"
BLUE="\e[34m"
YELLOW="\e[33m"

cls() {
printf "\ec"
}

sep() {
    printf -- ' %80s\n' ' ' | tr ' ' '-'
}

banner() {
printf "\e[48;2;0;0;0m          \e[38;2;3;0;8;48;2;0;0;0m▄\e[38;2;251;159;8;48;2;0;0;0m▄▄▄▄▄▄▄\e[38;2;249;158;6;48;2;0;4;1m▄\e[38;2;254;158;8;48;2;1;2;3m▄\e[38;2;10;0;1;48;2;0;0;0m▄\e[48;2;0;0;0m                          \e[38;2;0;2;8;48;2;0;0;0m▄\e[38;2;0;1;5;48;2;0;0;0m▄▄▄▄▄▄▄▄▄▄▄▄▄\e[38;2;174;123;49;48;2;0;0;0m▄\e[38;2;238;169;16;48;2;0;0;0m▄\e[38;2;0;4;1;48;2;0;0;0m▄\e[48;2;0;0;0m                \e[m
\e[48;2;0;0;0m        \e[38;2;2;0;10;48;2;0;0;0m▄\e[38;2;247;160;1;48;2;2;0;11m▄\e[38;2;6;4;6;48;2;249;162;1m▄\e[38;2;0;0;0;48;2;28;2;0m▄\e[38;2;0;0;0;48;2;17;2;0m▄▄▄▄▄▄\e[38;2;0;0;0;48;2;172;102;39m▄\e[38;2;0;0;0;48;2;253;159;21m▄\e[38;2;0;0;0;48;2;0;0;10m▄\e[48;2;0;0;0m                        \e[38;2;1;6;16;48;2;0;0;0m▄\e[38;2;254;159;1;48;2;0;4;18m▄\e[38;2;95;54;4;48;2;254;154;1m▄\e[38;2;0;0;0;48;2;250;154;5m▄\e[38;2;0;0;0;48;2;250;158;7m▄▄▄▄▄▄▄▄▄▄▄▄\e[38;2;0;2;4;48;2;250;154;7m▄\e[38;2;7;0;6;48;2;252;154;3m▄\e[38;2;0;0;0;48;2;0;0;4m▄\e[48;2;0;0;0m                \e[m
\e[48;2;0;0;0m  \e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;251;248;255;48;2;245;251;252m▄\e[38;2;6;0;2;48;2;177;0;253m▄\e[38;2;255;255;255;48;2;254;253;254m▄▄\e[38;2;250;254;254;48;2;178;0;255m▄\e[38;2;6;0;10;48;2;162;8;254m▄\e[38;2;5;0;9;48;2;162;8;254m▄\e[38;2;5;0;9;48;2;172;3;251m▄\e[38;2;253;254;250;48;2;247;250;247m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;0;0;3;48;2;170;4;254m▄\e[38;2;251;254;254;48;2;253;253;248m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;0;0;0;48;2;254;253;254m▄\e[38;2;0;0;2;48;2;254;253;254m▄▄▄▄▄\e[38;2;0;2;7;48;2;255;218;255m▄\e[38;2;1;0;6;48;2;248;254;242m▄\e[38;2;0;0;2;48;2;254;253;254m▄▄\e[38;2;0;0;0;48;2;254;253;254m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;0;0;0;48;2;254;253;254m▄\e[38;2;0;0;2;48;2;254;253;254m▄▄\e[38;2;2;1;4;48;2;254;254;241m▄\e[38;2;0;3;0;48;2;164;9;248m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;253;253;253;48;2;254;253;254m▄\e[38;2;254;254;254;48;2;254;253;254m▄▄▄\e[38;2;252;252;252;48;2;254;253;254m▄\e[38;2;255;255;255;48;2;254;253;254m▄▄\e[38;2;0;1;7;48;2;177;2;240m▄\e[38;2;255;255;255;48;2;254;253;254m▄▄\e[38;2;253;251;255;48;2;174;7;253m▄\e[38;2;9;2;13;48;2;158;9;254m▄\e[38;2;5;0;9;48;2;170;6;248m▄\e[38;2;5;0;9;48;2;172;3;251m▄\e[38;2;252;253;250;48;2;253;254;241m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;1;1;0;48;2;174;5;248m▄\e[38;2;170;6;248;48;2;173;4;253m▄\e[38;2;255;252;243;48;2;173;4;253m▄\e[38;2;172;4;254;48;2;173;4;253m▄\e[38;2;180;91;224;48;2;173;4;253m▄\e[38;2;254;222;255;48;2;173;4;253m▄\e[38;2;187;129;220;48;2;173;4;253m▄\e[38;2;255;207;255;48;2;173;4;253m▄\e[38;2;203;125;227;48;2;173;4;253m▄\e[38;2;137;29;207;48;2;173;4;250m▄\e[38;2;253;251;255;48;2;253;245;255m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;127;127;127;48;2;254;253;254m▄\e[38;2;0;0;0;48;2;254;253;254m▄▄▄\e[38;2;254;254;254;48;2;254;253;254m▄\e[38;2;255;255;255;48;2;254;254;253m▄\e[38;2;252;253;254;48;2;180;3;254m▄\e[38;2;2;3;0;48;2;166;5;253m▄\e[38;2;255;255;255;48;2;254;253;254m▄\e[38;2;254;254;254;48;2;254;253;254m▄\e[38;2;0;0;0;48;2;254;253;254m▄▄▄▄▄▄\e[48;2;0;0;0m  \e[m
\e[48;2;0;0;0m  \e[48;2;255;255;255m \e[48;2;254;254;254m \e[48;2;0;0;0m \e[48;2;255;255;255m  \e[38;2;4;4;4;48;2;254;254;254m▄\e[38;2;254;254;254;48;2;252;252;252m▄\e[38;2;3;3;3;48;2;0;0;0m▄\e[48;2;0;0;0m \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;254;254;254m \e[48;2;255;255;255m \e[38;2;2;2;2;48;2;0;0;0m▄\e[48;2;0;0;0m     \e[38;2;1;1;1;48;2;0;0;0m▄\e[48;2;0;0;0m    \e[48;2;255;255;255m \e[48;2;0;0;0m     \e[48;2;255;255;255m \e[38;2;252;252;252;48;2;254;254;254m▄\e[48;2;0;0;0m    \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;255;255;255m  \e[38;2;1;1;1;48;2;254;254;254m▄\e[48;2;254;254;254m \e[38;2;3;3;3;48;2;0;0;0m▄\e[48;2;0;0;0m \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;169;5;254m \e[38;2;255;242;255;48;2;160;52;203m▄\e[38;2;147;24;214;48;2;239;177;245m▄\e[38;2;249;249;243;48;2;162;49;217m▄\e[38;2;251;218;255;48;2;254;219;255m▄\e[38;2;195;151;220;48;2;190;108;239m▄\e[38;2;254;235;254;48;2;140;108;161m▄\e[38;2;195;140;217;48;2;171;39;228m▄\e[48;2;143;27;209m \e[48;2;255;255;255m  \e[48;2;127;127;127m \e[48;2;0;0;0m   \e[48;2;1;1;1m \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;255;255;255m \e[48;2;254;254;254m \e[48;2;0;0;0m        \e[m
\e[48;2;0;0;0m  \e[48;2;255;255;255m \e[48;2;254;254;254m \e[48;2;0;0;0m \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[38;2;0;0;0;48;2;177;177;177m▄\e[38;2;253;253;253;48;2;252;252;252m▄\e[38;2;252;252;252;48;2;0;0;0m▄\e[48;2;255;255;255m  \e[48;2;0;0;0m \e[38;2;0;0;0;48;2;254;254;254m▄\e[38;2;0;0;0;48;2;253;253;253m▄▄▄▄▄\e[38;2;255;255;255;48;2;253;253;253m▄\e[48;2;255;255;255m \e[48;2;239;239;239m \e[48;2;0;0;0m    \e[48;2;255;255;255m \e[48;2;0;0;0m     \e[48;2;255;255;255m \e[48;2;254;254;254m \e[38;2;0;0;0;48;2;253;253;253m▄▄▄\e[38;2;0;0;0;48;2;252;252;252m▄\e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[38;2;0;0;0;48;2;110;110;110m▄\e[38;2;254;254;254;48;2;255;255;255m▄\e[38;2;253;253;253;48;2;3;3;3m▄\e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;169;5;254m \e[38;2;253;242;250;48;2;220;196;223m▄\e[38;2;145;35;160;48;2;175;108;203m▄\e[38;2;223;166;250;48;2;172;81;215m▄\e[38;2;254;215;255;48;2;140;52;187m▄\e[38;2;198;135;233;48;2;236;252;228m▄\e[38;2;162;19;206;48;2;255;227;255m▄\e[38;2;158;12;229;48;2;182;78;218m▄\e[48;2;143;27;209m \e[48;2;255;255;255m  \e[48;2;127;127;127m \e[48;2;0;0;0m   \e[48;2;1;1;1m \e[48;2;255;255;255m  \e[48;2;0;0;0m \e[48;2;255;255;255m \e[48;2;254;254;254m \e[38;2;0;0;0;48;2;253;253;253m▄▄▄▄▄▄\e[38;2;0;0;0;48;2;1;1;1m▄\e[48;2;0;0;0m \e[m
\e[48;2;0;0;0m  \e[48;2;255;255;255m \e[38;2;255;247;255;48;2;254;254;254m▄\e[38;2;152;16;222;48;2;0;0;0m▄\e[48;2;255;255;255m \e[38;2;254;255;251;48;2;255;255;255m▄\e[38;2;157;12;227;48;2;0;0;0m▄▄▄\e[38;2;218;155;235;48;2;254;254;254m▄\e[48;2;255;255;255m  \e[38;2;148;19;212;48;2;0;0;0m▄\e[38;2;246;250;251;48;2;0;0;0m▄\e[38;2;251;251;251;48;2;0;0;0m▄▄▄▄▄\e[38;2;254;254;254;48;2;255;255;255m▄\e[48;2;255;255;255m \e[38;2;253;212;255;48;2;239;239;239m▄\e[38;2;157;12;227;48;2;0;0;0m▄▄▄\e[38;2;141;28;207;48;2;0;0;0m▄\e[48;2;255;255;255m \e[38;2;143;26;201;48;2;0;0;0m▄\e[38;2;157;12;227;48;2;0;0;0m▄▄▄\e[38;2;142;25;202;48;2;0;0;0m▄\e[48;2;255;255;255m \e[38;2;254;251;255;48;2;254;254;254m▄\e[38;2;157;12;227;48;2;0;0;0m▄▄▄\e[38;2;159;14;222;48;2;0;0;0m▄\e[48;2;255;255;255m  \e[38;2;151;16;221;48;2;0;0;0m▄\e[48;2;255;255;255m  \e[38;2;157;12;227;48;2;0;0;0m▄▄▄\e[38;2;188;107;222;48;2;253;253;253m▄\e[48;2;255;255;255m  \e[38;2;143;20;215;48;2;0;0;0m▄\e[38;2;169;4;254;48;2;169;5;254m▄\e[38;2;165;13;228;48;2;201;136;225m▄\e[38;2;165;9;230;48;2;203;127;228m▄\e[38;2;156;12;236;48;2;203;123;221m▄\e[38;2;162;17;211;48;2;182;114;208m▄\e[38;2;158;17;226;48;2;182;66;228m▄\e[38;2;167;12;224;48;2;194;99;228m▄\e[38;2;177;1;254;48;2;168;8;251m▄\e[38;2;163;6;248;48;2;143;27;209m▄\e[38;2;255;237;255;48;2;255;255;255m▄\e[48;2;255;255;255m \e[38;2;253;253;253;48;2;127;127;127m▄\e[38;2;251;251;251;48;2;0;0;0m▄▄\e[38;2;250;250;250;48;2;0;0;0m▄\e[38;2;255;255;255;48;2;5;5;5m▄\e[48;2;255;255;255m \e[38;2;248;255;246;48;2;255;255;255m▄\e[38;2;139;21;211;48;2;0;0;0m▄\e[48;2;255;255;255m \e[38;2;255;255;255;48;2;254;254;254m▄\e[38;2;251;251;251;48;2;0;0;0m▄▄▄▄▄▄\e[38;2;1;1;1;48;2;0;0;0m▄\e[48;2;0;0;0m \e[m
\e[48;2;0;0;0m  \e[38;2;0;0;0;48;2;150;150;150m▄\e[38;2;0;0;0;48;2;153;149;153m▄\e[38;2;0;0;0;48;2;103;6;154m▄\e[38;2;0;0;0;48;2;150;150;150m▄\e[38;2;0;0;0;48;2;150;150;149m▄\e[38;2;0;0;0;48;2;97;3;154m▄▄▄\e[38;2;0;0;0;48;2;94;4;153m▄\e[38;2;0;0;0;48;2;147;155;147m▄\e[38;2;0;0;0;48;2;150;150;150m▄\e[38;2;0;0;0;48;2;99;9;152m▄\e[38;2;0;0;0;48;2;151;149;148m▄\e[38;2;0;0;0;48;2;150;150;150m▄▄▄▄▄▄▄\e[38;2;0;0;0;48;2;155;127;155m▄\e[38;2;1;1;0;48;2;181;70;175m▄\e[38;2;230;159;28;48;2;201;67;162m▄\e[38;2;255;155;11;48;2;92;6;166m▄\e[38;2;0;2;9;48;2;90;13;139m▄\e[38;2;0;0;0;48;2;150;150;150m▄\e[38;2;0;0;0;48;2;94;7;142m▄\e[38;2;0;0;0;48;2;97;3;154m▄▄▄\e[38;2;0;0;0;48;2;94;7;142m▄\e[38;2;0;0;0;48;2;150;150;150m▄\e[38;2;0;0;0;48;2;143;147;152m▄\e[38;2;0;0;0;48;2;97;3;154m▄\e[38;2;4;0;0;48;2;174;65;183m▄\e[38;2;230;162;36;48;2;203;69;164m▄\e[38;2;255;153;4;48;2;101;9;160m▄\e[38;2;1;3;8;48;2;150;150;150m▄\e[38;2;4;0;11;48;2;150;150;150m▄\e[38;2;4;0;11;48;2;110;3;167m▄\e[38;2;4;0;11;48;2;150;150;150m▄\e[38;2;4;0;11;48;2;150;150;151m▄\e[38;2;4;0;11;48;2;97;3;154m▄▄\e[38;2;17;0;3;48;2;97;3;154m▄\e[38;2;250;159;7;48;2;95;4;153m▄\e[38;2;0;0;9;48;2;149;152;148m▄\e[38;2;0;0;0;48;2;150;150;150m▄\e[38;2;0;0;0;48;2;96;6;159m▄\e[38;2;0;0;0;48;2;97;3;154m▄▄▄▄▄▄▄▄▄\e[38;2;0;0;0;48;2;151;144;154m▄\e[38;2;0;0;0;48;2;150;150;150m▄▄▄▄▄▄\e[38;2;0;0;0;48;2;149;150;148m▄\e[38;2;0;0;0;48;2;95;4;151m▄\e[38;2;0;0;0;48;2;100;9;158m▄\e[38;2;0;0;0;48;2;150;150;150m▄▄▄▄▄▄▄▄\e[48;2;0;0;0m  \e[m
\e[48;2;0;0;0m                        \e[38;2;0;0;0;48;2;2;1;0m▄\e[38;2;1;1;0;48;2;234;163;40m▄\e[38;2;225;157;34;48;2;255;156;6m▄\e[38;2;254;154;7;48;2;1;3;12m▄\e[38;2;2;4;13;48;2;0;0;0m▄\e[48;2;0;0;0m        \e[38;2;0;0;0;48;2;4;0;0m▄\e[38;2;0;0;1;48;2;220;155;26m▄\e[38;2;2;0;0;48;2;255;157;6m▄▄▄▄▄▄▄\e[38;2;0;2;7;48;2;255;157;6m▄\e[38;2;23;0;0;48;2;255;157;6m▄\e[38;2;2;0;0;48;2;6;0;5m▄\e[48;2;0;0;0m                               \e[m
\e[48;2;0;0;0m                          \e[38;2;0;0;0;48;2;1;2;0m▄\e[38;2;1;1;0;48;2;218;150;30m▄\e[38;2;211;131;54;48;2;255;154;7m▄\e[38;2;247;157;10;48;2;24;3;0m▄▄▄▄▄▄▄▄▄▄▄▄▄\e[38;2;251;158;5;48;2;254;155;2m▄\e[38;2;255;158;2;48;2;255;154;4m▄\e[38;2;5;1;7;48;2;0;3;2m▄\e[48;2;0;0;0m                                   \e[m
\e[49;38;2;0;0;0m▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\e[49;38;2;1;0;5m▀\e[49;38;2;1;3;0m▀\e[49;38;2;0;0;0m▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\e[m
";
}

# Check for root privs
chkroot() {
if [ "$(id -u)" -ne 0 ]; then
  printf >&2 "Error: You must run the installer as root or with sudo! Exiting...\n"
  exit 1
fi
}

# Kill installer if certain items not found ############
bail() {
	printf "\n"
	printf " If you think this is a bug, please report it to\n"
	printf " -> https://github.com/btcinstanode/instanode/issues\n"
	printf "\n"
	printf " The installer will not continue from here...\n"
	printf "\n"
	exit 1
}

# Function to check for installed commands ##############
checkutil() {
	printf '%s' " * Checking for $1..."
	if command -v "$1" >/dev/null; then
		printf "ok!\n";
		return 0;
	else
		printf "not found!\n";
		return 1;
	fi
}

# Generate ssh keypair ####################################
makekey() {
	( checkutil ssh-keygen && checkutil ssh ) || bail
	if [ ! -e "$1" ]; then
		if ! ssh-keygen -t rsa -C "$USER" -f "$1"; then
			printf " Unable to make key with that location\n"
		else
			chmod go-rw "$1"
			printf " Successfully generated key\n"
			return
		fi
	else
		if ask " Unable to generate key, do you want to delete the file?" N; then
			if ! rm "$1"; then
				printf " Unable to delete file, resetting\n"
			else
				printf " File deleted\n"
				if ! ssh-keygen -t rsa -C "$USERe" -f "$1"; then
					printf " Unable to generate key, resetting\n"
				fi
			fi
		else
			printf " Unable to make key with that path, resetting\n"
		fi
	fi
}

